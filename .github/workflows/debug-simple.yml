name: 🔍 Simple Debug

on:
  workflow_dispatch:

jobs:
  debug:
    runs-on: macos-latest
    timeout-minutes: 15
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        channel: 'stable'
        cache: false
    
    - name: Basic Checks
      run: |
        echo "=== SYSTEM ==="
        sw_vers
        xcodebuild -version
        
        echo "=== FLUTTER ==="
        flutter --version
        flutter doctor
        
        echo "=== PROJECT ==="
        ls -la
        ls -la ios/
        
    - name: Test Build
      run: |
        echo "=== CLEAN & DEPS ==="
        flutter clean
        flutter pub get
        
        echo "=== TRY BUILD ==="
        flutter build ios --help
        
        echo "=== ACTUAL BUILD ==="
        flutter build ios --no-codesign 2>&1 | tee build.log || {
          echo "BUILD FAILED - SHOWING LAST 50 LINES:"
          tail -50 build.log
          exit 1
        }
        
    - name: Upload Build Log
      if: always()
      uses: actions/upload-artifact@v4
      with:
        name: build-log
        path: build.log
